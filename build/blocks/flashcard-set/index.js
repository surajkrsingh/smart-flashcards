(()=>{"use strict";var e={20:(e,t,a)=>{var s=a(609),l=Symbol.for("react.element"),r=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,a){var s,c={},i=null,d=null;for(s in void 0!==a&&(i=""+a),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(d=t.ref),t)r.call(t,s)&&!n.hasOwnProperty(s)&&(c[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===c[s]&&(c[s]=t[s]);return{$$typeof:l,type:e,key:i,ref:d,props:c,_owner:o.current}}},848:(e,t,a)=>{e.exports=a(20)},609:e=>{e.exports=window.React}},t={};function a(s){var l=t[s];if(void 0!==l)return l.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,a),r.exports}const s=window.wp.blocks,l=window.wp.i18n,r=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"smfcs/flashcard-set","version":"0.1.0","title":"Flashcard Set","category":"widgets","icon":"screenoptions","description":"Create a set of flashcards with navigation","attributes":{"currentSlide":{"type":"number","default":0},"displayMode":{"type":"string","default":"slide","enum":["slide","stack","grid"]},"enableShuffle":{"type":"boolean","default":false},"showNavigation":{"type":"boolean","default":true},"buttonBackgroundColor":{"type":"string","default":""},"buttonTextColor":{"type":"string","default":""}},"supports":{"align":["wide","full"],"html":false},"textdomain":"smart-flashcards","editorScript":"file:../../../build/blocks/flashcard-set/index.js"}');var o=a(609);const n=window.wp.blockEditor,c=window.wp.components,i=window.wp.element,d=window.wp.data,m="smfcs",h={FLASHCARD_SET:`${m}/flashcard-set`,FLASHCARD:`${m}/flashcard`,FLASHCARD_FRONT:`${m}/flashcard-front`,FLASHCARD_BACK:`${m}/flashcard-back`},f=[h.FLASHCARD],u=[[h.FLASHCARD]],p=window.wp.primitives;var v=a(848);const b=(0,v.jsx)(p.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,v.jsx)(p.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),_=(0,v.jsx)(p.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,v.jsx)(p.Path,{d:"m14.5 6.5-1 1 3.7 3.7H4v1.6h13.2l-3.7 3.7 1 1 5.6-5.5z"})}),g=(0,v.jsx)(p.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,v.jsx)(p.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),w=(0,v.jsx)(p.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,v.jsx)(p.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})});(0,s.registerBlockType)(r.name,{...r,title:(0,l.__)("Flashcard Set","smart-flashcards"),description:(0,l.__)("Create a set of flashcards with carousel navigation","smart-flashcards"),edit:function({attributes:e,setAttributes:t,clientId:a}){const{currentSlide:s=0,displayMode:r,enableShuffle:m,showNavigation:h=!0,buttonBackgroundColor:p="",buttonTextColor:v=""}=e,[k,y]=(0,i.useState)(!1),E=(0,n.useBlockProps)(),N=(0,i.useRef)(null),{innerBlocks:C,selectedBlockClientId:S,isBlockSelected:x}=(0,d.useSelect)((e=>({innerBlocks:e("core/block-editor").getBlocks(a),selectedBlockClientId:e("core/block-editor").getSelectedBlockClientId(),isBlockSelected:e("core/block-editor").isBlockSelected(a)})),[a]),{removeBlock:B,insertBlock:P,selectBlock:A}=(0,d.useDispatch)("core/block-editor"),R=C?.length||0;(0,i.useEffect)((()=>{k||(0===R&&T(),y(!0))}),[k]),(0,i.useEffect)((()=>{const e=()=>{N.current&&N.current.querySelectorAll(".wp-block-smfcs-flashcard").forEach(((e,t)=>{const a=e.querySelector('[data-type="smfcs/flashcard"]')||e;t===s?(e.classList.add("is-active"),a.style.setProperty("display","block","important"),a.style.setProperty("opacity","1","important"),a.style.setProperty("visibility","visible","important")):(e.classList.remove("is-active"),a.style.setProperty("display","none","important"),a.style.setProperty("opacity","0","important"),a.style.setProperty("visibility","hidden","important"))}))};e();const t=setTimeout(e,100);return()=>clearTimeout(t)}),[s,C,k]),(0,i.useEffect)((()=>{if(S&&C.length>0){const e=C.findIndex((e=>e.clientId===S||e.innerBlocks?.some((e=>e.clientId===S))));-1!==e&&e!==s&&t({currentSlide:e})}}),[S,C,s]);const T=()=>{const e=wp.blocks.createBlock("smfcs/flashcard",{index:R+1});P(e,R,a).then((()=>{A(e.clientId),t({currentSlide:R})}))},H=()=>{if(R>1){const e=C[s];if(e){B(e.clientId);const a=Math.min(s,R-2);t({currentSlide:a})}}},F=e=>{if(e>=0&&e<R){t({currentSlide:e});const a=C[e];a&&A(a.clientId)}};return(0,o.createElement)("div",{...E,ref:N,onClick:e=>{const t=e.target,s=t.classList.contains("wp-block-smfcs-flashcard-set"),l=t.classList.contains("flashcard-set-container"),r=t.closest(".flashcard-set-header"),o=t.closest("button"),n=t.closest(".wp-block-smfcs-flashcard"),c=t.closest(".flashcard-content"),i=t.closest(".block-editor-block-list__block");!(s||l||r)||n||c||i||o||(e.stopPropagation(),A(a))}},(0,o.createElement)(n.InspectorControls,null,(0,o.createElement)(c.PanelBody,{title:(0,l.__)("Flashcard Set Settings","smart-flashcards"),initialOpen:!0},(0,o.createElement)(c.SelectControl,{label:(0,l.__)("Display Mode","smart-flashcards"),value:r,options:[{label:(0,l.__)("Slide","smart-flashcards"),value:"slide"},{label:(0,l.__)("Stack","smart-flashcards"),value:"stack"},{label:(0,l.__)("Grid","smart-flashcards"),value:"grid"}],onChange:e=>t({displayMode:e})}),(0,o.createElement)(c.ToggleControl,{label:(0,l.__)("Enable Shuffle","smart-flashcards"),checked:m,onChange:e=>t({enableShuffle:e})})),(0,o.createElement)(c.PanelBody,{title:(0,l.__)("Navigation & Styling","smart-flashcards"),initialOpen:!1},(0,o.createElement)(c.ToggleControl,{label:(0,l.__)("Show Navigation","smart-flashcards"),help:(0,l.__)("Show/hide navigation buttons on frontend","smart-flashcards"),checked:h,onChange:e=>t({showNavigation:e})}),h&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"color-control-group"},(0,o.createElement)("label",{className:"color-control-label"},(0,l.__)("Button Background Color","smart-flashcards")),(0,o.createElement)(c.ColorPicker,{color:p,onChangeComplete:e=>t({buttonBackgroundColor:e.hex}),disableAlpha:!1}),p&&(0,o.createElement)(c.Button,{isSmall:!0,variant:"secondary",onClick:()=>t({buttonBackgroundColor:""}),style:{marginTop:"8px"}},(0,l.__)("Reset","smart-flashcards"))),(0,o.createElement)("div",{className:"color-control-group",style:{marginTop:"20px"}},(0,o.createElement)("label",{className:"color-control-label"},(0,l.__)("Button Text Color","smart-flashcards")),(0,o.createElement)(c.ColorPicker,{color:v,onChangeComplete:e=>t({buttonTextColor:e.hex}),disableAlpha:!1}),v&&(0,o.createElement)(c.Button,{isSmall:!0,variant:"secondary",onClick:()=>t({buttonTextColor:""}),style:{marginTop:"8px"}},(0,l.__)("Reset","smart-flashcards"))))),(0,o.createElement)(c.PanelBody,{title:(0,l.__)("Flashcard Navigation","smart-flashcards"),initialOpen:!0},(0,o.createElement)("div",{className:"flashcard-nav-sidebar"},(0,o.createElement)("div",{className:"current-flashcard-info"},(0,o.createElement)("strong",null,(0,l.__)("Current Flashcard:","smart-flashcards"))," ",s+1," / ",R),(0,o.createElement)("div",{className:"navigation-controls"},(0,o.createElement)("div",{className:"nav-buttons-row"},(0,o.createElement)(c.Button,{icon:b,variant:"secondary",onClick:()=>F(Math.max(0,s-1)),disabled:0===s,title:(0,l.__)("Previous flashcard","smart-flashcards"),className:"nav-button"},(0,l.__)("Previous","smart-flashcards")),(0,o.createElement)(c.Button,{icon:_,variant:"secondary",onClick:()=>F(Math.min(R-1,s+1)),disabled:s===R-1,title:(0,l.__)("Next flashcard","smart-flashcards"),className:"nav-button"},(0,l.__)("Next","smart-flashcards"))),(0,o.createElement)("div",{className:"action-buttons-row"},(0,o.createElement)(c.Button,{icon:g,variant:"primary",onClick:T,title:(0,l.__)("Add new flashcard","smart-flashcards"),className:"add-button"},(0,l.__)("Add Flashcard","smart-flashcards")),(0,o.createElement)(c.Button,{icon:w,variant:"secondary",onClick:H,disabled:R<=1,isDestructive:!0,title:(0,l.__)("Remove current flashcard","smart-flashcards"),className:"remove-button"},(0,l.__)("Remove","smart-flashcards"))))))),(0,o.createElement)("div",{className:"flashcard-set-header",onClick:e=>{e.target.closest("button")||(e.stopPropagation(),A(a))}},(0,o.createElement)("div",{className:"flashcard-set-title"},(0,o.createElement)("strong",null,(0,l.__)("Flashcard Set","smart-flashcards")),(0,o.createElement)("span",{className:"mode-indicator"},"(",r," mode)")),(0,o.createElement)("div",{className:"flashcard-navigation-header"},(0,o.createElement)(c.Button,{icon:b,variant:"secondary",onClick:e=>{e.stopPropagation(),F(Math.max(0,s-1))},disabled:0===s,title:(0,l.__)("Previous flashcard","smart-flashcards"),className:"nav-button-header nav-previous",size:"small"},(0,l.__)("Previous","smart-flashcards")),(0,o.createElement)(c.Button,{icon:g,variant:"primary",onClick:e=>{e.stopPropagation(),T()},title:(0,l.__)("Add new flashcard","smart-flashcards"),className:"nav-button-header add-button-header",size:"small"}),(0,o.createElement)("div",{className:"flashcard-position-indicator"},(0,o.createElement)("span",{className:"current-position"},s+1),(0,o.createElement)("span",{className:"position-separator"},"/"),(0,o.createElement)("span",{className:"total-count"},R)),(0,o.createElement)(c.Button,{icon:w,variant:"secondary",onClick:e=>{e.stopPropagation(),H()},disabled:R<=1,isDestructive:!0,title:(0,l.__)("Remove current flashcard","smart-flashcards"),className:"nav-button-header remove-button-header",size:"small"}),(0,o.createElement)(c.Button,{icon:_,variant:"secondary",onClick:e=>{e.stopPropagation(),F(Math.min(R-1,s+1))},disabled:s===R-1,title:(0,l.__)("Next flashcard","smart-flashcards"),className:"nav-button-header nav-next",size:"small"},(0,l.__)("Next","smart-flashcards")))),(0,o.createElement)("div",{className:"flashcard-set-container"},(0,o.createElement)(n.InnerBlocks,{allowedBlocks:f,template:u,templateLock:!1})))},save:function({attributes:e}){const{displayMode:t,enableShuffle:a,showNavigation:s=!0,buttonBackgroundColor:r="",buttonTextColor:c=""}=e,i={};r&&(i["--button-bg-color"]=r),c&&(i["--button-text-color"]=c);const d=n.useBlockProps.save({"data-display-mode":t,"data-enable-shuffle":a,"data-show-navigation":s,style:Object.keys(i).length>0?i:void 0});return(0,o.createElement)("div",{...d},(0,o.createElement)("div",{className:"flashcard-set-wrapper"},(0,o.createElement)("div",{className:"flashcard-set-slides"},(0,o.createElement)("div",{className:"flashcard-set-track"},(0,o.createElement)(n.InnerBlocks.Content,null))),"grid"!==t&&s&&(0,o.createElement)("div",{className:"flashcard-set-nav"},a&&(0,o.createElement)("button",{type:"button",className:"flashcard-shuffle-button","aria-label":(0,l.__)("Shuffle flashcards","smart-flashcards")},(0,o.createElement)("span",{className:"dashicons dashicons-randomize"}),(0,l.__)("Shuffle","smart-flashcards")),(0,o.createElement)("button",{type:"button",className:"flashcard-nav-button prev","aria-label":(0,l.__)("Previous flashcard","smart-flashcards")},(0,o.createElement)("span",{className:"dashicons dashicons-arrow-left-alt2"}),(0,l.__)("Previous","smart-flashcards")),(0,o.createElement)("span",{className:"flashcard-set-counter"},"1 / 1"),(0,o.createElement)("button",{type:"button",className:"flashcard-nav-button next","aria-label":(0,l.__)("Next flashcard","smart-flashcards")},(0,l.__)("Next","smart-flashcards"),(0,o.createElement)("span",{className:"dashicons dashicons-arrow-right-alt2"})))))}})})();